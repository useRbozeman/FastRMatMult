#include<R.h>

void mat_mult_iter_c(double *A, double *B, double *AB, int *outer_dim1, 
                     int *outer_dim2, int *inner_dim)
{
int i, j, k;

for(i=0; i < *outer_dim1; ++i) {
  for(j=0; j < *outer_dim2; ++j) {
    AB[j + i * (*outer_dim2)]=0;
    for(k=0; k < *inner_dim; ++k) {
      AB[ j + i*(*outer_dim2)] += A[i+k*(*outer_dim1)]*B[k+ j * (*inner_dim)];
    }
  }
}
}
